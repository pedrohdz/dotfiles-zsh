#!/usr/bin/env bash

set -o errexit
set -o nounset
set -o pipefail

#----
# Configuration
#----
polipo_home="$HOME/.polipo"
config="$polipo_home/config-dr"
polipo_server=$(which polipo)
base_command="$polipo_server -c $config"


#----
# Reporting
#----
echo "==============================================================================="
echo "Executable:     $polipo_server"
echo "Home directory: $polipo_home"
echo "Configuration:  $config"
echo "Base command:   $base_command"
echo "==============================================================================="


#----
# Run
#----
# perform expiry on the disk cache.
$base_command -x

# Start up the service
$base_command

# perform expiry on the disk cache.
$base_command -x

